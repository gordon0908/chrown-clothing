{"ast":null,"code":"var _jsxFileName = \"/Users/gordon/mywork/mytraining/2020-v1/complete-react-developer-in-2020-fromPaul/crown-app/src/App.js\";\nimport React from 'react';\nimport { Switch, Route, Redirect } from 'react-router-dom';\nimport './App.css';\nimport Header from './components/header/header.component';\nimport Homepage from './pages/homepage/homepage.component';\nimport Shop from './pages/shop/shop.component';\nimport SignInAndSignUp from './pages/sign-in-and-sign-up/sign-in-and-sign-up.component';\nimport { auth, createUser } from './firebase/firebase.util';\nimport { connect } from 'react-redux';\nimport { createCurrentUser } from './components/redux/user/user-action';\n\nclass App extends React.Component {\n  constructor() {\n    super(...arguments); // this.state = {\n    //   currentUser: null\n    // };\n\n    this.subscribeFromGoogle = null;\n  }\n\n  componentDidMount() {\n    this.subscribeFromGoogle = auth.onAuthStateChanged(async currentUser => {\n      const {\n        addCurrentUser\n      } = this.props;\n\n      if (currentUser) {\n        const useProfile = await createUser(currentUser);\n        useProfile.onSnapshot(snapShot => {\n          addCurrentUser({\n            id: snapShot.id,\n            ...snapShot.data()\n          }); // this.setState({\n          //   currentUser: {\n          //     id: snapShot.id,\n          //     ...snapShot.data()\n          //   }\n          // }, ()=> {\n          //   console.log(this.state.currentUser)\n          // })\n        });\n      }\n\n      addCurrentUser(currentUser);\n    });\n  }\n\n  componentWillUnmount() {\n    this.subscribeFromGoogle && this.subscribeFromGoogle();\n  }\n\n  render() {\n    const {\n      currentUser\n    } = this.props;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Header, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(Switch, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Route, {\n      exact: true,\n      path: \"/\",\n      component: Homepage,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      path: \"/shop\",\n      component: Shop,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      exact: true,\n      path: \"/signin\",\n      render: () => currentUser ? /*#__PURE__*/React.createElement(Redirect, {\n        to: \"/\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 65\n        }\n      }) : /*#__PURE__*/React.createElement(SignInAndSignUp, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 87\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 11\n      }\n    })));\n  }\n\n}\n\nconst mapStateToProps = ({\n  user\n}) => ({\n  currentUser: user.currentUser\n});\n\nconst mapDispatchToProps = dispatch => ({\n  addCurrentUser: currentUser => dispatch(createCurrentUser(currentUser))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);","map":{"version":3,"sources":["/Users/gordon/mywork/mytraining/2020-v1/complete-react-developer-in-2020-fromPaul/crown-app/src/App.js"],"names":["React","Switch","Route","Redirect","Header","Homepage","Shop","SignInAndSignUp","auth","createUser","connect","createCurrentUser","App","Component","constructor","arguments","subscribeFromGoogle","componentDidMount","onAuthStateChanged","currentUser","addCurrentUser","props","useProfile","onSnapshot","snapShot","id","data","componentWillUnmount","render","mapStateToProps","user","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Switch, Route, Redirect } from 'react-router-dom';\nimport './App.css';\n\nimport Header from './components/header/header.component';\nimport Homepage from './pages/homepage/homepage.component';\nimport Shop from './pages/shop/shop.component';\nimport SignInAndSignUp from './pages/sign-in-and-sign-up/sign-in-and-sign-up.component';\nimport { auth, createUser } from './firebase/firebase.util';\nimport { connect } from 'react-redux';\nimport { createCurrentUser } from './components/redux/user/user-action';\n\nclass App extends React.Component {\n  constructor() {\n    super(...arguments);\n    // this.state = {\n    //   currentUser: null\n    // };\n    this.subscribeFromGoogle = null;\n  }\n  componentDidMount() {\n    \n\n    this.subscribeFromGoogle = auth.onAuthStateChanged(async currentUser => {\n      const { addCurrentUser } = this.props;\n\n      if (currentUser) {\n        const useProfile = await createUser(currentUser);\n\n        useProfile.onSnapshot(snapShot => {\n          addCurrentUser({\n            id: snapShot.id,\n            ...snapShot.data()\n          });\n          // this.setState({\n          //   currentUser: {\n          //     id: snapShot.id,\n          //     ...snapShot.data()\n          //   }\n          // }, ()=> {\n          //   console.log(this.state.currentUser)\n          // })\n        });\n      }\n\n      addCurrentUser(currentUser);\n    });\n  }\n  componentWillUnmount() {\n    this.subscribeFromGoogle && this.subscribeFromGoogle();\n  }\n  render() {\n    const { currentUser } = this.props;\n\n    return (\n      <div>\n  \n        <Header/>\n        <Switch>\n          <Route exact path=\"/\" component={Homepage}  />\n          <Route path=\"/shop\" component={Shop} />\n          <Route exact path=\"/signin\" render={()=> currentUser? <Redirect to=\"/\" /> : <SignInAndSignUp />} />\n        </Switch>\n  \n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = ({ user }) => ({\n  currentUser: user.currentUser\n})\n\nconst mapDispatchToProps = dispatch => ({\n  addCurrentUser: currentUser => dispatch(createCurrentUser(currentUser))\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\n"]},"metadata":{},"sourceType":"module"}