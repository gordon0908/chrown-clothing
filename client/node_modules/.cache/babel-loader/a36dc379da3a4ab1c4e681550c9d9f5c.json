{"ast":null,"code":"var _jsxFileName = \"/Users/gordon/mywork/mytraining/2020-v1/complete-react-developer-in-2020-fromPaul/crown-app/src/App.js\";\nimport React from 'react';\nimport { Switch, Route, Redirect } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { createStructuredSelector } from 'reselect';\nimport { auth, createUser, createCollection } from './firebase/firebase.util';\nimport { selectCurrentUser } from './components/redux/user/user-selector';\nimport { selectCollectionForPreview } from './components/redux/shop/shop-selector';\nimport Header from './components/header/header.component';\nimport Homepage from './pages/homepage/homepage.component';\nimport Shop from './pages/shop/shop.component';\nimport SignInAndSignUp from './pages/sign-in-and-sign-up/sign-in-and-sign-up.component';\nimport { createCurrentUser } from './components/redux/user/user-action';\nimport Checkout from './pages/checkout/checkout.component';\nimport './App.css';\n\nclass App extends React.Component {\n  constructor() {\n    super(...arguments); // this.state = {\n    //   currentUser: null\n    // };\n\n    this.subscribeFromGoogle = null;\n  }\n\n  componentDidMount() {\n    this.subscribeFromGoogle = auth.onAuthStateChanged(async currentUser => {\n      const {\n        addCurrentUser\n      } = this.props;\n\n      if (currentUser) {\n        const useProfile = await createUser(currentUser);\n        useProfile.onSnapshot(snapShot => {\n          addCurrentUser({\n            id: snapShot.id,\n            ...snapShot.data()\n          }); // this.setState({\n          //   currentUser: {\n          //     id: snapShot.id,\n          //     ...snapShot.data()\n          //   }\n          // }, ()=> {\n          //   console.log(this.state.currentUser)\n          // })\n        });\n      }\n\n      addCurrentUser('collection', currentUser);\n      createCollection(this.props.shopCollection);\n    });\n  }\n\n  componentWillUnmount() {\n    this.subscribeFromGoogle && this.subscribeFromGoogle();\n  }\n\n  render() {\n    const {\n      currentUser\n    } = this.props;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Header, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(Switch, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Route, {\n      exact: true,\n      path: \"/\",\n      component: Homepage,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      path: \"/shop\",\n      component: Shop,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      exact: true,\n      path: \"/signin\",\n      render: () => currentUser ? /*#__PURE__*/React.createElement(Redirect, {\n        to: \"/\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 65\n        }\n      }) : /*#__PURE__*/React.createElement(SignInAndSignUp, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 87\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      path: \"/checkout\",\n      component: Checkout,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 11\n      }\n    })));\n  }\n\n} // const mapStateToProps = ({ user }) => ({\n//   currentUser: user.currentUser\n// });\n\n\nconst mapStateToProps = createStructuredSelector({\n  currentUser: selectCurrentUser,\n  shopCollection: selectCollectionForPreview\n});\n\nconst mapDispatchToProps = dispatch => ({\n  addCurrentUser: currentUser => dispatch(createCurrentUser(currentUser))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);","map":{"version":3,"sources":["/Users/gordon/mywork/mytraining/2020-v1/complete-react-developer-in-2020-fromPaul/crown-app/src/App.js"],"names":["React","Switch","Route","Redirect","connect","createStructuredSelector","auth","createUser","createCollection","selectCurrentUser","selectCollectionForPreview","Header","Homepage","Shop","SignInAndSignUp","createCurrentUser","Checkout","App","Component","constructor","arguments","subscribeFromGoogle","componentDidMount","onAuthStateChanged","currentUser","addCurrentUser","props","useProfile","onSnapshot","snapShot","id","data","shopCollection","componentWillUnmount","render","mapStateToProps","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Switch, Route, Redirect } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { createStructuredSelector } from 'reselect';\n\nimport { auth, createUser, createCollection } from './firebase/firebase.util';\nimport { selectCurrentUser } from './components/redux/user/user-selector';\n\nimport { selectCollectionForPreview } from './components/redux/shop/shop-selector';\n\nimport Header from './components/header/header.component';\nimport Homepage from './pages/homepage/homepage.component';\nimport Shop from './pages/shop/shop.component';\nimport SignInAndSignUp from './pages/sign-in-and-sign-up/sign-in-and-sign-up.component';\nimport { createCurrentUser } from './components/redux/user/user-action';\nimport Checkout from './pages/checkout/checkout.component';\n\nimport './App.css';\n\n\nclass App extends React.Component {\n  constructor() {\n    super(...arguments);\n    // this.state = {\n    //   currentUser: null\n    // };\n    this.subscribeFromGoogle = null;\n  }\n  componentDidMount() {\n    \n\n    this.subscribeFromGoogle = auth.onAuthStateChanged(async currentUser => {\n      const { addCurrentUser } = this.props;\n\n      if (currentUser) {\n        const useProfile = await createUser(currentUser);\n\n        useProfile.onSnapshot(snapShot => {\n          addCurrentUser({\n            id: snapShot.id,\n            ...snapShot.data()\n          });\n          // this.setState({\n          //   currentUser: {\n          //     id: snapShot.id,\n          //     ...snapShot.data()\n          //   }\n          // }, ()=> {\n          //   console.log(this.state.currentUser)\n          // })\n        });\n      }\n\n      addCurrentUser('collection', currentUser);\n\n\n      createCollection(this.props.shopCollection);\n    });\n  }\n  componentWillUnmount() {\n    this.subscribeFromGoogle && this.subscribeFromGoogle();\n  }\n  render() {\n    const { currentUser } = this.props;\n\n    return (\n      <div>\n  \n        <Header/>\n        <Switch>\n          <Route exact path=\"/\" component={Homepage}  />\n          <Route path=\"/shop\" component={Shop} />\n          <Route exact path=\"/signin\" render={()=> currentUser? <Redirect to=\"/\" /> : <SignInAndSignUp />} />\n          <Route path=\"/checkout\" component={Checkout}/>\n        </Switch>\n  \n      </div>\n    );\n  }\n}\n\n// const mapStateToProps = ({ user }) => ({\n//   currentUser: user.currentUser\n// });\n\nconst mapStateToProps = createStructuredSelector({\n  currentUser: selectCurrentUser,\n  shopCollection: selectCollectionForPreview\n});\n\nconst mapDispatchToProps = dispatch => ({\n  addCurrentUser: currentUser => dispatch(createCurrentUser(currentUser))\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\n"]},"metadata":{},"sourceType":"module"}